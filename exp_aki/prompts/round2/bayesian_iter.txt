The goal is to come up with a concept bottleneck model (CBM) that extracts {num_concepts} meta-concepts from clinical notes from the electronic health record of pediatric patients admitted to the emergency room to predict acute kidney injury (AKI) for patients undergoing anesthesia during surgery. A meta-concept is a binary feature extractor defined by a yes/no question of the form "Does the note mention this patient having…?" or “Does the note mention this surgery…?”. We have {num_concepts_fixed} meta-concepts so far:
{meta_concepts}

To come up with the {num_concepts}th meta-concept, I have done the following: I first fit a CBM on the {num_concepts_fixed} existing meta-concepts. Then to figure out how to improve this {num_concepts_fixed}-concept CBM, I extracted a list of concepts that are present in each note, and then fit a linear regression model on the extracted concepts to predict the residuals of the {num_concepts_fixed}-concept CBM. These are the top extracted concepts in the resulting residual model, in descending order of importance:

{top_features_df}

To interpret this residual model, a general rule of thumb is that an extracted concept with a large positive coefficient means that a high risk of AKI is positively associated with the concept being mentioned in the note, and an extracted concept with a negative coefficient means that a higher risk of AKI is negatively associated with the concept being mentioned in the note. 

Given the residual model above, create cohesive candidates for the {num_concepts}th meta-concept. Be systematic and consider all the listed concepts in the residual model. Start from the most to the least predictive concept. For each concept, check if it matches an existing meta-concept or create a new candidate meta-concept. Work down the list, iterating through each concept. Clearly state each candidate meta-concept as a yes/no question.

Suggestions for generating candidate meta-concepts: 
* Do not propose meta-concepts that are simply a union of two different concepts (e.g. "Does the note mention this patient having an infection or being elderly?" is not allowed), questions with answers that are almost always a yes (e.g. the answer to "Does the note mention this patient being hospitalized?" is almost always yes), or questions where the yes/no options are not clearly defined (e.g. "Does the note mention this patient experiencing difficulty?" is not clearly defined because difficulty may mean financial difficulty, physical difficulties, etc).
* Do not propose meta-concepts where you would expect over 95% agreement or disagreement with the {num_concepts_fixed} existing meta-concepts (e.g. "Does the note mention the patient having homelessness?" overlaps too much with "Does the note mention the patient having housing insecurity?").
* The CBM should encompass concepts from two categories: (i) characteristics of the patient and (ii) characteristics of the surgery that together influence the patient’s risk of developing AKI.
* Some concepts like cardiovascular disease, coronary artery disease, and gastrointestinal discomfort are too broad. For instance, some cardiovascular diseases are life-threatening and others are almost not worth mentioning when considering the clinical outcome. Focus on concepts that distinguish between patients having low versus high risk. 
* Rather than having concepts that ask if a patient has a disease diagnosis, consider concepts like “Does the note mention the patient experiencing symptoms related to ____?”
* Concepts that clinical experts suggested considering include:
 - ​​Patient characteristics: fluid accumulation, abnormal/ normal pulmonary findings, heart failure symptoms, acid reflux, bleeding disorders, abnormal laboratory values, creatinine levels, multiple medications, active infection requiring antibiotics, functional capacity (e.g., METS score, good exercise tolerance), untreated coronary artery disease
 - Pre-surgical status: location prior to surgery (ICU, hospital ward, or home), if the patient is intubated or needs supplemental oxygen
 - Surgical characteristics: anticipated bleeding risk, expected surgical duration, need for blood transfusion during the procedure, certain types of surgery that may be lower or higher risk for developing AKI

Propose at least ten candidates. Answer with a list of JSONs, one per line:
Finally, summarize all the generated candidates for the {num_concepts}-th meta-concept in a JSON. Merge any candidate meta-concepts that are essentially the same (where you would expect over 95% agreement) or essentially opposites (you would expect over 95% disagreement). In the JSON, include a list of comma-separated list of phrases that mean the same or opposite of each candidate meta-concept. The final JSON should have the following format:

Answer in the following JSON format:
{
  "reasoning": "Step-by-step explanation of how you systematically worked through the residual model concepts (from most to least predictive).”,
  "concepts": [
    {
      "concept": "<QUESTION 1>",
      "words": ["<SYNONYM/ANTONYM 1>", "<SYNONYM/ANTONYM 2>", "<SYNONYM/ANTONYM 3>"]
    },
    {
      "concept": "<QUESTION 2>",
      "words": ["<SYNONYM/ANTONYM 1>", "<SYNONYM/ANTONYM 2>", "<SYNONYM/ANTONYM 3>"]
    },
    ...
    {
      "concept": "<QUESTION 10>",
      "words": ["<SYNONYM/ANTONYM 1>", "<SYNONYM/ANTONYM 2>", "<SYNONYM/ANTONYM 3>"]
    }
  ]
}


Example answer:
{
  "reasoning": "Step-by-step reasoning through the residual model concepts",
   "concepts": [
    {
      "concept": "Does the note mention the patient having fluid accumulation?",
      "words": [“fluid buildup”, “fluid collection”, “dehydration”]
    },
    {
      "concept": “Does the note mention the patient having a normal pulmonary exam?”
      "words": [“clear lungs”, “wheezing, “lungs clear”]
    },
    {
      "concept": "Does the note mention the patient having heart failure?",
      "words": [“CHF”, “cardiac failure”, “HF”]
    },
    ...
]
}
